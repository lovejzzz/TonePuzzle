<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tone Puzzle - Music Training Game</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="title-container">
                    <h1><span class="title-tone">Tone</span><span class="title-puzzle">Puzzle</span></h1>
                    <a href="tutorial.html" id="tutorial-link" class="tutorial-icon" aria-label="Tutorial" style="transform: scale(0.5); transform-origin: left center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12" y2="17"></line>
                        </svg>
                    </a>
                </div>
                <button id="start-game">Start Game</button>
                
                <div class="mode-toggle header-mode-toggle">
                    <span>Visual Mode</span>
                    <label class="switch">
                        <input type="checkbox" id="mode-switch">
                        <span class="slider round"></span>
                    </label>
                    <span>Ear Mode</span>
                </div>
                
                <div class="score-container" id="level-display">
                    <span>Level: </span>
                    <span id="score">1-1</span>
                    <select id="level-selector" class="hidden-selector">
                        <option value="1-1">1-1</option>
                        <option value="1-2">1-2</option>
                        <option value="1-3">1-3</option>
                        <option value="2-1">2-1</option>
                        <option value="2-2">2-2</option>
                        <option value="2-3">2-3</option>
                        <option value="3-1">3-1</option>
                        <option value="3-2">3-2</option>
                        <option value="3-3">3-3</option>
                        <option value="4-1">4-1</option>
                        <option value="4-2">4-2</option>
                        <option value="4-3">4-3</option>
                        <option value="5-1">5-1</option>
                        <option value="5-2">5-2</option>
                        <option value="5-3">5-3</option>
                        <option value="6-1">6-1</option>
                        <option value="6-2">6-2</option>
                        <option value="6-3">6-3</option>
                        <option value="7-1">7-1</option>
                        <option value="7-2">7-2</option>
                        <option value="7-3">7-3</option>
                        <option value="8-1">8-1</option>
                        <option value="8-2">8-2</option>
                        <option value="8-3">8-3</option>
                        <option value="9-1">9-1</option>
                        <option value="9-2">9-2</option>
                        <option value="9-3">9-3</option>
                        <option value="10-1">10-1</option>
                        <option value="10-2">10-2</option>
                        <option value="10-3">10-3</option>
                        <option value="11-1">11-1</option>
                        <option value="11-2">11-2</option>
                        <option value="11-3">11-3</option>
                        <option value="12-1">12-1</option>
                        <option value="12-2">12-2</option>
                        <option value="12-3">12-3</option>
                    </select>
                </div>
            </div>
        </header>

        <main>
            <div class="game-area">
                <div class="sequence-display">
                    <div class="sequence-header">
                        <h2>Original Sequence</h2>
                        <button id="replay-sequence" class="replay-btn" title="Replay Sequence">
                            <span>▶</span>
                        </button>
                    </div>
                    <div id="original-sequence" class="sequence"></div>
                </div>

                <div class="piano-container">
                    <div class="keyboard">
                        <!-- White keys -->
                        <div class="white-key piano-key" id="key0" data-note="C3"></div>
                        <div class="white-key piano-key" id="key2" data-note="D3"></div>
                        <div class="white-key piano-key" id="key4" data-note="E3"></div>
                        <div class="white-key piano-key" id="key5" data-note="F3"></div>
                        <div class="white-key piano-key" id="key7" data-note="G3"></div>
                        <div class="white-key piano-key" id="key9" data-note="A3"></div>
                        <div class="white-key piano-key" id="key11" data-note="B3"></div>
                        <div class="white-key piano-key" id="key12" data-note="C4"></div>
                        <div class="white-key piano-key" id="key14" data-note="D4"></div>
                        <div class="white-key piano-key" id="key16" data-note="E4"></div>
                        <div class="white-key piano-key" id="key17" data-note="F4"></div>
                        <div class="white-key piano-key" id="key19" data-note="G4"></div>
                        <div class="white-key piano-key" id="key21" data-note="A4"></div>
                        <div class="white-key piano-key" id="key23" data-note="B4"></div>
                        <div class="white-key piano-key" id="key24" data-note="C5"></div>

                        <!-- Black keys -->
                        <div class="black-key piano-key" id="key1" data-note="C#3"></div>
                        <div class="black-key piano-key" id="key3" data-note="D#3"></div>
                        <div class="black-key piano-key" id="key6" data-note="F#3"></div>
                        <div class="black-key piano-key" id="key8" data-note="G#3"></div>
                        <div class="black-key piano-key" id="key10" data-note="A#3"></div>
                        <div class="black-key piano-key" id="key13" data-note="C#4"></div>
                        <div class="black-key piano-key" id="key15" data-note="D#4"></div>
                        <div class="black-key piano-key" id="key18" data-note="F#4"></div>
                        <div class="black-key piano-key" id="key20" data-note="G#4"></div>
                        <div class="black-key piano-key" id="key22" data-note="A#4"></div>
                    </div>
                    <!-- Piano controls section removed as button moved to header -->
                </div>

                <div class="sequence-input">
                    <div class="sequence-header">
                        <h2>Your Sequence</h2>
                        <div class="sequence-controls">
                            <button id="play-user-sequence" class="replay-btn" title="Play Your Sequence">
                                <span>▶</span>
                            </button>
                            <button id="clear-user-sequence" class="clear-btn" title="Clear Your Sequence">
                                Clear
                            </button>
                            <button id="submit-sequence" class="submit-btn" title="Submit Sequence (Space)">
                                Submit
                            </button>
                        </div>
                    </div>
                    <div id="user-sequence" class="sequence"></div>
                </div>
            </div>



            <div class="controls">                
                <div id="midi-status" class="midi-status disconnected">MIDI <span class="midi-dot"></span></div>
            </div>
        </main>
    </div>

    <script src="piano.js"></script>
    <script src="game.js"></script>
    <script>
        // Handle mode parameter from tutorial page
        window.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get('mode');
            const modeSwitch = document.getElementById('mode-switch');
            const tutorialLink = document.getElementById('tutorial-link');
            
            // Update tutorial link with current mode
            function updateTutorialLink() {
                const isEarMode = modeSwitch.checked;
                tutorialLink.href = `tutorial.html?mode=${isEarMode ? 'ear' : 'visual'}`;
            }
            
            // Add event listener to mode switch to update tutorial link
            modeSwitch.addEventListener('change', updateTutorialLink);
            
            // Initialize based on URL parameters
            if (mode === 'ear') {
                // Set to ear mode
                modeSwitch.checked = true;
                // Apply dark theme
                document.body.classList.add('dark-theme');
                // Auto-start the game if coming from tutorial
                setTimeout(() => {
                    document.getElementById('start-game').click();
                }, 500);
            } else if (mode === 'visual') {
                // Set to visual mode
                modeSwitch.checked = false;
                // Remove dark theme
                document.body.classList.remove('dark-theme');
                // Auto-start the game if coming from tutorial
                setTimeout(() => {
                    document.getElementById('start-game').click();
                }, 500);
            }
            
            // Initialize tutorial link with current mode
            updateTutorialLink();
        });
    </script>
</body>
</html> 